
<!DOCTYPE html>
<html>
	<script src="/dist/canvasClass.js"></script>
	<script type="text/javascript">
		let canvasClasses = new Map();


		var canvas,
			ctx,
			flag = false,
			prevX = 0,
			currX = 0,
			prevY = 0,
			currY = 0,
			dot_flag = false;
		first = true;
		var x = 'black',
			y = 2;
		var cmap;
		function init() {
			/* c1 = new CanvasClass('can');
			canvasClasses.set('can', c1);
			c2 = new CanvasClass('can2');
			canvasClasses.set('can2', c2);
			cmap = canvasClasses.get('can'); */
			initCanvas('can');
			initCanvas('can2');
			// cmap.canvas.addEventListener("mousemove", function(e) {c1.move(e)}, false);
			//canvasClasses.get('can').canvas.addEventListener("resize", function(e) {onCanvasSizeChange()}, false);
          //canvasClasses.get('can').canvas.addEventListener("scroll", function(e) {onCanvasSizeChange()}, false);
          //window.onscroll = canvasClasses.get('can').onCanvasSizeChange();
       
		}
		function initCanvas(canvasId)
		{
			var canvas = canvasClasses.get(canvasId);
			if(canvas === undefined)
				{
					var canvas = canvas = document.getElementById(canvasId);
					if(canvas === null)
						return;
					canvasClasses.set(canvasId, new CanvasClass(canvasId));
				}
		}
		function updateCanvasImage(imageId)
		{
			
			var canvas = canvasClasses.get(canvasId);
			if(canvas != undefined)
				{
					var canvas = canvasClasses.get(canvasId);
					if(canvas === null)
						return;
					canvas 
				}
		}
        //window.onscroll = function (e) { CanvasRedraw(); }  
          // window.onresize = function (e) { CanvasRedraw(); } 
        //   window.addEventListener('resize', CanvasRedraw);
		/* function init() {
        canvas = document.getElementById('can');
        ctx = canvas.getContext("2d");
        w = canvas.width;
        h = canvas.height;
    
        canvas.addEventListener("mousemove", function (e) {
            findxy('move', e)
        }, false);
        canvas.addEventListener("mousedown", function (e) {
            findxy('down', e)
        }, false);
        canvas.addEventListener("mouseup", function (e) {
            findxy('up', e)
        }, false);
        canvas.addEventListener("mouseout", function (e) {
            findxy('out', e)
        }, false);
    } */

		function color(obj) {
			switch (obj.id) {
				case 'green':
					x = 'green';
					break;
				case 'blue':
					x = 'blue';
					break;
				case 'red':
					x = 'red';
					break;
				case 'yellow':
					x = 'yellow';
					break;
				case 'orange':
					x = 'orange';
					break;
				case 'black':
					x = 'black';
					break;
				case 'white':
					x = 'white';
					break;
			}
			if (x == 'white') y = 14;
			else y = 2;
		}

		function erase() {
			var m = confirm('Want to clear');
			if (m) {
				ctx.clearRect(0, 0, w, h);
				document.getElementById('canvasimg').style.display = 'none';
				first = true;
			}
		}
        function CanvasRedraw()
        {
            /* canvasClasses.forEach(
               (value,key) => { value.onCanvasSizeChange}
            ) */
            for(var i=0; i<canvasClasses.length;i++)
            {
                canvasClasses[i].onCanvasSizeChange();
            }
			canvasClasses.get('can').onCanvasSizeChange();
        }
		function OnNewline(canvasId) {
			var id = canvasClasses.get(canvasId);
			if (id) {
				id.newLine = true;
				id.bDrawOnMove = false;
                id.lastDraw = {x: -1, y:-1};
			}
			first = true;
		}
		function OnUnDo(canvasId)
		{
			var id = canvasClasses.get(canvasId);
			if (id) {
				id.unDo();
			}
		}
		function mouseDraw(canvasId) {
			var id = canvasClasses.get(canvasId);
			if (id) {
				id.newLine = false;
				id.bDrawOnMove = true;
			}
		}
		function setCanvasImage(canvasId, imageId)
		{

		}
		function save() {
			document.getElementById('canvasimg').style.border = '2px solid';
			var dataURL = canvas.toDataURL();
			document.getElementById('canvasimg').src = dataURL;
			document.getElementById('canvasimg').style.display = 'inline';
		}
	</script>
	<body onload="init()" onresize="CanvasRedraw()" onscroll="CanvasRedraw()">
		<canvas 
			id="can"
			width="40"
			height="40"
			style="position: absolute; top: 10%; left: 10%; border: 2px solid"
		></canvas>
		<div style="position: absolute; top: 12%; left: 43%">Choose Color</div>
		<div
			style="
				position: absolute;
				top: 15%;
				left: 45%;
				width: 10px;
				height: 10px;
				background: green;
			"
			id="green"
			onclick="color(this)"
		></div>
		<div
			style="
				position: absolute;
				top: 15%;
				left: 46%;
				width: 10px;
				height: 10px;
				background: blue;
			"
			id="blue"
			onclick="color(this)"
		></div>
		<div
			style="
				position: absolute;
				top: 15%;
				left: 47%;
				width: 10px;
				height: 10px;
				background: red;
			"
			id="red"
			onclick="color(this)"
		></div>
		<div
			style="
				position: absolute;
				top: 17%;
				left: 45%;
				width: 10px;
				height: 10px;
				background: yellow;
			"
			id="yellow"
			onclick="color(this)"
		></div>
		<div
			style="
				position: absolute;
				top: 17%;
				left: 46%;
				width: 10px;
				height: 10px;
				background: orange;
			"
			id="orange"
			onclick="color(this)"
		></div>
		<div
			style="
				position: absolute;
				top: 17%;
				left: 47%;
				width: 10px;
				height: 10px;
				background: black;
			"
			id="black"
			onclick="color(this)"
		></div>
		<div style="position: absolute; top: 20%; left: 43%">Eraser</div>
		<div
			style="
				position: absolute;
				top: 22%;
				left: 45%;
				width: 15px;
				height: 15px;
				background: white;
				border: 2px solid;
			"
			id="white"
			onclick="color(this)"
		></div>
		<img
			id="canvasimg"
			style="position: absolute; top: 10%; left: 52%;display: none;"
		/>
		<input
			type="button"
			value="save"
			id="btn"
			size="30"
			onclick="save()"
			style="position: absolute; top: 55%; left: 10%"
		/>
		<input
			type="button"
			value="clear"
			id="clr"
			size="23"
			onclick="erase()"
			style="position: absolute; top: 55%; left: 15%"
		/>
		<input
			type="button"
			value="new lines"
			id="newLine"
			size="23"
			onclick="OnNewline('can')"
			style="position: absolute; top: 55%; left: 25%"
		/>
		<input
			type="button"
			value="mouseDraw"
			id="mouseDraw"
			size="23"
			onclick="mouseDraw('can')"
			style="position: absolute; top: 55%; left: 35%"
		/>
			<input
			type="button"
			value="unDo"
			id="unDo"
			size="23"
			onclick="OnUnDo('can')"
			style="position: absolute; top: 55%; left: 40%"
		/>
		<canvas
			id="can2"
			width="40"
			height="40"
			style="position: absolute; top: 70%; left: 10%; border: 2px solid"
		></canvas>
	</body>
</html>
